<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìƒí’ˆ ëª©ë¡</title>
    <style>
        /* ì „ì²´ í˜ì´ì§€ ìŠ¤íƒ€ì¼ */
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }

        /* í—¤ë” ìŠ¤íƒ€ì¼ */
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
        }

        /* ë¡œë”© ë©”ì‹œì§€ ìŠ¤íƒ€ì¼ */
        .loading {
            text-align: center;
            font-size: 18px;
            color: #666;
        }

        /* ìƒí’ˆ ëª©ë¡ ì»¨í…Œì´ë„ˆ */
        .product-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }

        /* ê°œë³„ ìƒí’ˆ ì¹´ë“œ ìŠ¤íƒ€ì¼ */
        .product-card {
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
            transition: transform 0.3s ease;
        }

        .product-card:hover {
            transform: translateY(-5px);
        }

        /* ìƒí’ˆ ì´ë¯¸ì§€ ìŠ¤íƒ€ì¼ */
        .product-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
            background-color: #eee;
        }

        /* ìƒí’ˆ ì •ë³´ ì˜ì—­ */
        .product-info {
            padding: 15px;
        }

        .product-name {
            font-size: 18px;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }

        .product-price {
            font-size: 16px;
            color: #e74c3c;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .product-stock {
            font-size: 14px;
            color: #27ae60;
            margin-bottom: 8px;
        }

        .product-discount {
            background-color: #e74c3c;
            color: white;
            padding: 3px 8px;
            border-radius: 5px;
            font-size: 12px;
            display: inline-block;
            margin-bottom: 8px;
        }

        .product-details {
            font-size: 12px;
            color: #666;
            line-height: 1.5;
        }

        /* ì˜µì…˜ í‘œì‹œ */
        .product-options {
            margin-top: 10px;
            font-size: 12px;
            color: #555;
        }

        .option-item {
            background-color: #f8f9fa;
            padding: 3px 6px;
            margin: 2px;
            border-radius: 3px;
            display: inline-block;
        }

        /* ì—ëŸ¬ ë©”ì‹œì§€ ìŠ¤íƒ€ì¼ */
        .error {
            text-align: center;
            color: #e74c3c;
            font-size: 16px;
            padding: 20px;
            background-color: #fdf2f2;
            border-radius: 5px;
            margin: 20px auto;
            max-width: 500px;
        }
    </style>
</head>
<body>
    <h1>ğŸ›ï¸ ìƒí’ˆ ëª©ë¡</h1>
    
    <!-- ë¡œë”© ë©”ì‹œì§€ -->
    <div id="loading" class="loading">ìƒí’ˆì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
    
    <!-- ìƒí’ˆ ëª©ë¡ì´ ë“¤ì–´ê°ˆ ì»¨í…Œì´ë„ˆ -->
    <div id="productContainer" class="product-container"></div>

    <script>
        // APIì—ì„œ ìƒí’ˆ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” í•¨ìˆ˜
        async function fetchProducts() {
            try {
                // ë¡œë”© ë©”ì‹œì§€ í‘œì‹œ
                document.getElementById('loading').style.display = 'block';
                
                // API í˜¸ì¶œ
                const response = await fetch('https://dev.wenivops.co.kr/services/fastapi-crud/1/product');
                
                // ì‘ë‹µì´ ì„±ê³µì ì´ì§€ ì•Šìœ¼ë©´ ì—ëŸ¬ ì²˜ë¦¬
                if (!response.ok) {
                    throw new Error('ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                }
                
                // JSON ë°ì´í„°ë¡œ ë³€í™˜
                const products = await response.json();
                
                // ë¡œë”© ë©”ì‹œì§€ ìˆ¨ê¸°ê¸°
                document.getElementById('loading').style.display = 'none';
                
                // ìƒí’ˆ ëª©ë¡ í™”ë©´ì— í‘œì‹œ
                displayProducts(products);
                
            } catch (error) {
                // ì—ëŸ¬ ë°œìƒ ì‹œ ì²˜ë¦¬
                console.error('ì—ëŸ¬:', error);
                document.getElementById('loading').style.display = 'none';
                document.getElementById('productContainer').innerHTML = 
                    '<div class="error">âŒ ìƒí’ˆì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + error.message + '</div>';
            }
        }

        // ìƒí’ˆ ëª©ë¡ì„ í™”ë©´ì— í‘œì‹œí•˜ëŠ” í•¨ìˆ˜
        function displayProducts(products) {
            const container = document.getElementById('productContainer');
            
            // ìƒí’ˆì´ ì—†ëŠ” ê²½ìš°
            if (!products || products.length === 0) {
                container.innerHTML = '<div class="error">í‘œì‹œí•  ìƒí’ˆì´ ì—†ìŠµë‹ˆë‹¤.</div>';
                return;
            }
            
            // ê° ìƒí’ˆì„ HTMLë¡œ ë³€í™˜
            const productHTML = products.map(product => {
                // í• ì¸ê°€ ê³„ì‚°
                const discountedPrice = product.discountRate > 0 
                    ? Math.floor(product.price * (1 - product.discountRate / 100))
                    : product.price;
                
                // ì˜µì…˜ ëª©ë¡ ìƒì„±
                const optionsHTML = product.option && product.option.length > 0
                    ? product.option.map(opt => 
                        `<span class="option-item">${opt.optionName} (+${opt.additionalFee.toLocaleString()}ì›)</span>`
                      ).join('')
                    : '';
                
                return `
                    <div class="product-card">
                        <img src="${product.thumbnailImg}" 
                             alt="${product.productName}" 
                             class="product-image"
                             onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZGRkIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzk5OSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPuydtOuvuOyngCDsl4bsnYw8L3RleHQ+PC9zdmc+'">
                        
                        <div class="product-info">
                            <div class="product-name">${product.productName}</div>
                            
                            ${product.discountRate > 0 ? 
                                `<div class="product-discount">${product.discountRate}% í• ì¸</div>
                                 <div class="product-price">
                                     <s style="color: #999; font-size: 14px;">${product.price.toLocaleString()}ì›</s>
                                     ${discountedPrice.toLocaleString()}ì›
                                 </div>` :
                                `<div class="product-price">${product.price.toLocaleString()}ì›</div>`
                            }
                            
                            <div class="product-stock">
                                ${product.stockCount > 0 ? 
                                    `âœ… ì¬ê³  ${product.stockCount}ê°œ` : 
                                    'âŒ í’ˆì ˆ'
                                }
                            </div>
                            
                            <div class="product-details">
                                ğŸšš ë°°ì†¡ë¹„: ${product.shippingFee.toLocaleString()}ì›<br>
                                ğŸ‘€ ì¡°íšŒìˆ˜: ${product.viewCount.toLocaleString()}íšŒ<br>
                                ğŸ“… ë“±ë¡ì¼: ${new Date(product.pubDate).toLocaleDateString()}
                            </div>
                            
                            ${optionsHTML ? `<div class="product-options">ì˜µì…˜: ${optionsHTML}</div>` : ''}
                        </div>
                    </div>
                `;
            }).join('');
            
            // HTMLì„ ì»¨í…Œì´ë„ˆì— ì‚½ì…
            container.innerHTML = productHTML;
        }

        // í˜ì´ì§€ê°€ ë¡œë“œë˜ë©´ ìƒí’ˆ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
        document.addEventListener('DOMContentLoaded', fetchProducts);
    </script>
</body>
</html>